<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>

    <!--插件id-->
    <id>com.baomidou.plugin.idea.mybatisx</id>
    <name>MyBatisX</name>
    <vendor email="jobob@qq.com" url="https://gitee.com/baomidou/MybatisX">MybatisX</vendor>

    <description>It aims to realize the most convenient IDEA hot update plug-in, reduce user operation steps, and
        provide zero-configuration visual operation updates. Currently, hot updates of MapperXML and Java files are
        supported. The details are similar to update records. Public account: CodeRevolt, which updates high-quality CS
        articles from time to time.
    </description>

    <!-- please see https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html
         on how to target different products -->
    <depends>com.intellij.modules.platform</depends>


    <resource-bundle>messages.messages</resource-bundle>

    <description><![CDATA[
          MybatisX plugin
          Features:
       <ul>
          <li>mapper and xml can jump back and forth</li>
          <li>mybatis.xml,mapper.xml prompt</li>
          <li>mapper and xml support auto prompt like jpa (reference  MybatisCodeHelperPro)</li>
          <li>integrate mybatis generator Gui (copy from free mybatis plugin)</li>
      </ul>

      QQ群号: 829161197
      ]]>
    </description>

    <change-notes><![CDATA[
      <h4>1.4.8</h4>
      <ul>
          <li>change style of generate code by templates</li>
          <li>fixed some bugs</li>
      </ul>
       <h4>1.3.6</h4>
      <ul>
          <li>fixed some bugs</li>
          <li>fixed advance tip for jpa</li>
          <li>fixed xml generate for multi module</li>
          <li>fixed alias scan for springboot</li>
      </ul>
      ]]>
    </change-notes>

    <idea-version since-build="202.0"/>
    <depends>com.intellij.modules.java</depends>
    <depends optional="true" config-file="database.xml">com.intellij.database</depends>
    <!-- support aliases -->
    <depends optional="true" config-file="spring.xml">com.intellij.spring</depends>
    <!-- support aliases -->
    <depends optional="true" config-file="spring-boot.xml">com.intellij.spring.boot</depends>
    <depends optional="true" config-file="withKotlin.xml">org.jetbrains.kotlin</depends>
    <depends optional="true" config-file="injection-mybatisx.xml">org.intellij.intelliLang</depends>
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>

    <actions>
        <!-- Add your actions here -->
        <action id="com.baomidou.plugin.idea.mybatisx.actions.MyBatisConsoleLogSqlParamsSetterAction"
                class="com.baomidou.plugin.idea.mybatisx.actions.MyBatisConsoleLogSqlParamsSetterAction"
                text="SQL Params Setter" icon="/icons/pluginIcon.svg">
            <add-to-group group-id="ConsoleEditorPopupMenu" anchor="first"/>
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </action>

        <action id="com.baomidou.plugin.idea.mybatisx.intention.JavaBeanToolAction"
                class="com.baomidou.plugin.idea.mybatisx.intention.JavaBeanToolAction"
                text="JavaBean Tool" icon="/icons/bean.svg">
            <!--Idea顶部工具栏 Generate Java Doc菜单后-->
            <add-to-group group-id="ToolsMenu" anchor="after" relative-to-action="GenerateJavadoc"/>
        </action>

        <!--        <action-->
        <!--            id="com.baomidou.plugin.idea.mybatisx.hotswap.HotSwapAction"-->
        <!--            class="com.baomidou.plugin.idea.mybatisx.hotswap.HotSwapAction"-->
        <!--            text="HotSwap">-->
        <!--            <add-to-group group-id="EditorPopupMenu" anchor="first"/>-->
        <!--        </action>-->

        <!--            id 全局唯一-->
        <!-- popup属性：决定该Group是否允许子菜单     -->
        <!-- icon：图标，需要配置为全限定命名    -->
        <!-- 不配置compact属性，表示该Group需要支持子菜单    -->
        <group
                id="FileHotswapAction"
                class="com.baomidou.plugin.idea.mybatisx.agent.action.FileHotSwapActionGroup"
                text="File Hot Swap"
                popup="true">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>
    </actions>


    <extensions defaultExtensionNs="com.intellij">

        <!-- Add your extensions here -->
        <!--notify 2020.3版本后需在plugin中注册-->
        <notificationGroup displayType="BALLOON" id="notifyAction"/>

        <projectService id="baomidou.TemplatesSettings"
                        serviceImplementation="com.baomidou.plugin.idea.mybatisx.generate.setting.TemplatesSettings"/>
        <!--文件描述-->
        <!-- mapper.xml文件属性提示 -->
        <dom.fileMetaData id="baomidou.MapperDescription"
                          rootTagName="mapper"
                          implementation="com.baomidou.plugin.idea.mybatisx.dom.description.MapperDescription"/>
        <!-- mybatis配置文件属性提示 -->
        <dom.fileMetaData id="baomidou.ConfigurationDescription"
                          rootTagName="configuration"
                          implementation="com.baomidou.plugin.idea.mybatisx.dom.description.ConfigurationDescription"/>

        <!-- Ctrl+B, 定位类的跳转, 定位方法的跳转 -->
        <definitionsScopedSearch id="baomidou.MapperClassSearch"
                                 implementation="com.baomidou.plugin.idea.mybatisx.system.definitionsearch.MapperClassSearch"/>
        <!-- 与搜索配套的跳转 -->
        <gotoTargetRendererProvider order="first"
                                    implementation="com.baomidou.plugin.idea.mybatisx.provider.GotoMapperXmlSchemaTypeRendererProvider"/>

        <!--项目服务-->
        <projectService id="baomidou.JavaService"
                        serviceImplementation="com.baomidou.plugin.idea.mybatisx.service.JavaService"/>
        <projectService id="baomidou.AnnotationService"
                        serviceImplementation="com.baomidou.plugin.idea.mybatisx.service.AnnotationService"/>
        <projectService id="baomidou.EditorService"
                        serviceImplementation="com.baomidou.plugin.idea.mybatisx.service.EditorService"/>
        <projectService id="baomidou.AliasFacade"
                        serviceImplementation="com.baomidou.plugin.idea.mybatisx.alias.AliasFacade"/>

        <projectService id="baomidou.MapperLocator"
                        serviceImplementation="com.baomidou.plugin.idea.mybatisx.locator.MapperLocator"/>

        <!--代码行插件，实现代码导航功能-->
        <!-- java 跳转到 xml  -->
        <codeInsight.lineMarkerProvider id="baomidou.MapperLineMarkerProvider" language="JAVA"
                                        implementationClass="com.baomidou.plugin.idea.mybatisx.provider.MapperLineMarkerProvider"/>
        <!-- xml 跳转到 java -->
        <codeInsight.lineMarkerProvider id="baomidou.StatementLineMarkerProvider" language="XML"
                                        implementationClass="com.baomidou.plugin.idea.mybatisx.provider.MyBatisMapperStatementLineMarkerProvider"/>
        <!-- 在service层注入了mapper对象, 在这个对象进行跳转到 mapper 类-->
        <codeInsight.lineMarkerProvider id="baomidou.InjectionLineMarkerProvider" language="JAVA"
                                        implementationClass="com.baomidou.plugin.idea.mybatisx.provider.InjectionLineMarkerProvider"/>

        <!-- 设置中的配置 -->
        <applicationConfigurable id="com.baomidou.plugin.idea.mybatisx.setting.MyBatisConfigurable"
                                 displayName="MyBatisX"
                                 instance="com.baomidou.plugin.idea.mybatisx.setting.MyBatisConfigurable"/>
        <!--模板设置-->
        <applicationConfigurable id="com.baomidou.plugin.idea.mybatisx.setting.TemplateConfigurable"
                                 displayName="Template"
                                 parentId="com.baomidou.plugin.idea.mybatisx.setting.MyBatisConfigurable"
                                 instance="com.baomidou.plugin.idea.mybatisx.setting.TemplateConfigurable"/>

        <applicationConfigurable id="com.baomidou.plugin.idea.mybatisx.setting.DataTypeConfigurable"
                                 displayName="DataType"
                                 parentId="com.baomidou.plugin.idea.mybatisx.setting.MyBatisConfigurable"
                                 instance="com.baomidou.plugin.idea.mybatisx.setting.DataTypeConfigurable"/>

        <!-- xml 标签提示 -->
        <!-- 在mapper.xml内部, 进行智能提示, 例如: #{提示位置} -->
        <completion.contributor id="baomidou.SqlParamCompletionContributor" language="SQL"
                                implementationClass="com.baomidou.plugin.idea.mybatisx.system.contributor.SqlParamCompletionContributor"
                                order="first"/>
        <!-- jpa规范提示, 在mapper类声明方法提示, 提示字符串完成后, 后续可以根据字符串生成方法参数和XML内容 -->
        <completion.contributor id="baomidou.MapperMethodCompletionContributor" language="JAVA"
                                implementationClass="com.baomidou.plugin.idea.mybatisx.system.contributor.MapperMethodCompletionContributor"/>


        <!--文件模板组，新建文件选择模板, 这里只是定义一个模板, 在mapper类方法定义完成后, 可以根据这个空模板生成一个文件 -->
        <fileTemplateGroup id="baomidou.MybatisFileTemplateDescriptorFactory"
                           implementation="com.baomidou.plugin.idea.mybatisx.system.template.MyBatisFileTemplateDescriptorFactory"/>

        <!--附加的LiveTemplate模板-->
        <defaultLiveTemplates id="baomidou.SqlLiveTemplateProvider"
                              file="liveTemplates/sql"/>

        <!-- Mapper类 重命名 -->
        <refactoring.elementListenerProvider id="baomidou.MapperRefactoringProvider"
                                             implementation="com.baomidou.plugin.idea.mybatisx.system.refactoring.MapperRefactoringProvider"/>

        <!-- 语法校验，让没有生成代码的方法产生错误 -->
        <localInspection language="JAVA" shortName="MybatisXMapperMethodInspection"
                         id="baomidou.MybatisMapperMethodInspection"
                         displayName="Mapper method inspection"
                         groupName="Mybatis" enabledByDefault="true" level="ERROR"
                         implementationClass="com.baomidou.plugin.idea.mybatisx.inspection.MapperMethodInspection"/>
        <localInspection language="XML" shortName="MybatisXMapperXmlInspection"
                         enabledByDefault="true"
                         level="ERROR"
                         id="baomidou.MybatisMapperXmlInspection"
                         displayName="Mapper xml inspection"
                         groupName="Mybatis"
                         hasStaticDescription="true"
                         implementationClass="com.baomidou.plugin.idea.mybatisx.inspection.MapperXmlInspection"/>

        <!--提示动作 start-->
        <!-- 生成参数注解 @Param -->
        <intentionAction id="baomidou.GenerateParamAnnotationIntention">
            <className>com.baomidou.plugin.idea.mybatisx.intention.GenerateParamAnnotationIntention</className>
        </intentionAction>
        <!-- 通过方法名生成对应的 查询语句 -->
        <intentionAction id="baomidou.GenerateStatementIntention">
            <className>com.baomidou.plugin.idea.mybatisx.intention.GenerateStatementIntention</className>
        </intentionAction>
        <!-- 生成mybatis mapper.xml文件 -->
        <intentionAction order="first" id="baomidou.GenerateMapperIntention">
            <className>com.baomidou.plugin.idea.mybatisx.intention.GenerateMapperIntention</className>
        </intentionAction>
        <!-- mybatis mapper.xml 文件 提示 if test -->
        <intentionAction id="baomidou.MapperXmlIfTestHintIntention">
            <className>com.baomidou.plugin.idea.mybatisx.intention.MapperXmlIfTestHintIntention</className>
        </intentionAction>
        <!-- mybatis mapper.xml 文件 提示 foreach -->
        <intentionAction id="baomidou.MapperXmlForeachHintIntention">
            <className>com.baomidou.plugin.idea.mybatisx.intention.MapperXmlForeachHintIntention</className>
        </intentionAction>
        <!-- 根据jpa名字生成方法和xml文件内容 -->
        <intentionAction id="baomidou.GenerateMapperMethodSmartJpaAction">
            <className>com.baomidou.plugin.idea.mybatisx.jpa.GenerateSmartJpaAction</className>
        </intentionAction>

        <intentionAction id="baomidou.GenerateMapperMethodSmartAdvanceJpaAction">
            <className>com.baomidou.plugin.idea.mybatisx.jpa.GenerateSmartJpaAdvanceAction</className>
        </intentionAction>
        <!--提示动作 end-->

        <!-- mybatis的xml和mapper类 文件图标都改成一只鸟-->
        <iconProvider id="baomidou.XmlAndMapperIconProvider"
                      implementation="com.baomidou.plugin.idea.mybatisx.provider.XmlAndMapperIconProvider"/>

        <!-- mapper.xml文件 #{} 区域的引用跳转 -->
        <psi.referenceContributor id="hashMarkerReferenceContributor"
                                  language="XML"
                                  implementation="com.baomidou.plugin.idea.mybatisx.reference.ContextHashMarkReferenceContributor"/>

        <!-- 应用服务, 必须放在主文件,否则 XmlAndMapperIconProvider 会加载不到-->
        <applicationService id="baomidou.MybatisSetting"
                            serviceImplementation="com.baomidou.plugin.idea.mybatisx.setting.MyBatisXSettings"/>

        <applicationService
            id="com.baomidou.plugin.idea.mybatisx.setting.GlobalTemplateSettings"
            serviceImplementation="com.baomidou.plugin.idea.mybatisx.setting.GlobalTemplateSettings"/>

        <applicationService
            id="com.baomidou.plugin.idea.mybatisx.setting.DataTypeMappingSettings"
            serviceImplementation="com.baomidou.plugin.idea.mybatisx.setting.DataTypeMappingSettings"/>

        <!-- 使用 Alt+Delete 删除方法时, 也删掉对应的标签 -->
        <refactoring.safeDeleteProcessor
                implementation="com.baomidou.plugin.idea.mybatisx.system.refactoring.MapperMethodSafeDeleteProcessor"/>

    </extensions>

    <!--    <projectListeners>-->
    <!--        <listener class="com.baomidou.plugin.idea.mybatisx.hotswap.HotSwapExecutionListener"-->
    <!--                  topic="com.intellij.execution.ExecutionListener"/>-->
    <!--    </projectListeners>-->

    <applicationListeners>
        <listener
                topic="com.intellij.ide.AppLifecycleListener"
                class="com.baomidou.plugin.idea.mybatisx.boot.PluginInitializer"
                activeInTestMode="false"/>
    </applicationListeners>

    <projectListeners>
        <listener class="com.baomidou.plugin.idea.mybatisx.agent.listener.ProjectExecutionListener"
                  topic="com.intellij.execution.ExecutionListener"/>
    </projectListeners>
</idea-plugin>
